package Algorithms.algorithm.others;

public class IsMach {
    public static void main(String[] str) {
        //System.out.println(isMatch("aa", "aa"));
        System.out.println(isMatch("aab", "c*a*b"));
    }
    
    public static boolean isMatch(String s, String p) {
        if (s == null || p == null) {
            return false;
        }
        
        return help(s, p, 0, 0);
    }
    
    public static boolean help(String s, String p, int indexS, int indexP) {
        int pLen = p.length();
        int sLen = s.length();
        
        // 1. P?????????????????? S?????????????????? 
        if (indexP == pLen) {
            return indexS == sLen;  
        }
        
        // 2. P ??????????????????????????????
        if (indexP == pLen - 1) {
            // ????????????????????????p???'.'.  
            // S????????????????????????
            return indexS == sLen - 1 && matchChar(s, p, indexS, indexP);
        }
        
        // ??????P ????????????2?????????.
        
        // 2. ?????????????????????, ??? aa, a. ????????????
        if (p.charAt(indexP + 1) != '*') {
           if (indexS < sLen && matchChar(s, p, indexS, indexP)) {
               return help(s, p, indexS + 1, indexP + 1);  // p??????????????????
           } else {
               return false;
           }
        }
        
        // 3. ?????????????????????, ??? .* or a* ,????????????????????????
        
        // ??????????????????2??????????????????????????????????????????
        if (help(s, p, indexS, indexP + 2)) {  
            return true;
        }
        
        // ?????????????????????,?????????????????????p????????? ??????1???????????????
        for (int i = indexS; i < sLen; i++) {
            if (!matchChar(s, p, i, indexP)) {
                return false;
            } else {
                if (help(s, p, i + 1, indexP + 2)) {
                    return true;
                }
            }
        }
        
        // ??????????????????????????????????????????????????????????????????????????????
        return false;
    }
    
    // check if the s match p in the index.
    public static boolean matchChar(String s, String p, int indexS, int indexP) {
        return (s.charAt(indexS) == p.charAt(indexP)) || p.charAt(indexP) == '.';
    }
}
